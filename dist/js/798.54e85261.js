"use strict";(self["webpackChunkedmsvue"]=self["webpackChunkedmsvue"]||[]).push([[798],{6445:function(e,t,s){s.r(t),s.d(t,{default:function(){return ne}});var o=s(3396),a=s(9242),r=s(7139);const i=e=>((0,o.dD)("data-v-9077ffcc"),e=e(),(0,o.Cn)(),e),l={class:"x y ml-5"},n={class:"card elevation-3"},d=i((()=>(0,o._)("div",{class:"card-header"},[(0,o._)("h3",{class:"card-title"},[(0,o._)("b",null,"List of All Workflows")])],-1))),c={class:"row mt-2"},u=i((()=>(0,o._)("div",{class:"col-md-9"},null,-1))),h={class:"col-md-2 ml-3"},m={class:"form-workflow"},w={id:"accordion"},p=["id"],_={class:"col-md-10"},f=i((()=>(0,o._)("b",null,"Start Folder: ",-1))),b={class:"mr-5"},g=i((()=>(0,o._)("b",null,"End Folder: ",-1))),k={class:"mr-5"},v=i((()=>(0,o._)("b",null,"Step Count: ",-1))),y={class:"mr-5"},C=i((()=>(0,o._)("b",null,"Updated At: ",-1))),D={class:"mr-5"},x={class:"mb-0 col-md-2"},A=["data-target","aria-controls"],M=i((()=>(0,o._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0",style:{border:"none"}},"arrow_drop_down",-1))),z=[M],E=["id","aria-labelledby"],H={class:"card-body"},R={class:"permissions-table"},T={id:"inner_accordion"},$=["id"],O={class:"col-md-10"},B=i((()=>(0,o._)("b",null,"Folder: ",-1))),U={class:"mr-5"},Y=i((()=>(0,o._)("b",null,"Workstep Type: ",-1))),j={class:"mr-5"},F=i((()=>(0,o._)("b",null,"Activity: ",-1))),W={class:"mr-5"},I=i((()=>(0,o._)("b",null,"Description: ",-1))),S={class:"mr-5"},L=i((()=>(0,o._)("b",null,"Updated At: ",-1))),G={class:"mr-5"},X={class:"mb-0 col-md-2"},q=["data-target","aria-controls"],K=i((()=>(0,o._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0",style:{border:"none"}},"arrow_drop_down",-1))),N=[K],Z=["id","aria-labelledby"],P={class:"card-body"},V={class:"permissions-table"};function J(e,t,s,i,M,K){const J=(0,o.up)("EditDocument"),Q=(0,o.up)("ContextMenu");return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("div",n,[d,(0,o._)("div",c,[u,(0,o._)("div",h,[(0,o._)("form",m,[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>M.searchTerm=e),placeholder:"Search...",class:"form-workflow rounded"},null,512),[[a.nr,M.searchTerm]])])])]),(0,o._)("div",w,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(K.filteredRows,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:"card m-5",key:t},[(0,o._)("div",{class:"card-header row",id:"heading"+t},[(0,o._)("div",_,[f,(0,o._)("span",b,(0,r.zw)(e.start_folder),1),g,(0,o._)("span",k,(0,r.zw)(e.end_folder),1),v,(0,o._)("span",y,(0,r.zw)(e.steps_count),1),C,(0,o._)("span",D,(0,r.zw)(e.updated_at),1)]),(0,o._)("h5",x,[(0,o._)("button",{class:"btn","data-toggle":"collapse","data-target":"#"+t,"aria-expanded":"false","aria-controls":t},z,8,A)])],8,p),(0,o._)("div",{id:t,class:"collapse","aria-labelledby":"heading"+t,"data-parent":"#accordion"},[(0,o._)("div",H,[(0,o._)("div",R,[(0,o._)("div",T,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:"card m-2",key:t},[(0,o._)("div",{class:"card-header row",id:"heading_inner"+t},[(0,o._)("div",O,[B,(0,o._)("span",U,(0,r.zw)(e.folder.name),1),Y,(0,o._)("span",j,(0,r.zw)(e.workstep_type),1),F,(0,o._)("span",W,(0,r.zw)(e.activity),1),I,(0,o._)("span",S,(0,r.zw)(e.description),1),L,(0,o._)("span",G,(0,r.zw)(e.updated_at),1)]),(0,o._)("h5",X,[(0,o._)("button",{class:"btn","data-toggle":"collapse","data-target":"#inner"+t,"aria-expanded":"false","aria-controls":t},N,8,q)])],8,$),(0,o._)("div",{id:"inner"+t,class:"collapse","aria-labelledby":"heading_inner"+t,"data-parent":"#inner_accordion"},[(0,o._)("div",P,[(0,o._)("div",V,[(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.possible_actions,((e,t)=>((0,o.wg)(),(0,o.iD)("li",{key:t}," Name: "+(0,r.zw)(e.name)+" Description: "+(0,r.zw)(e.description)+" Next Workstep: "+(0,r.zw)(e.next_workstep.activity)+" updated_at: "+(0,r.zw)(e.updated_at),1)))),128))])])])],8,Z)])))),128))])])])],8,E)])))),128))]),e.showEditDocument?((0,o.wg)(),(0,o.j4)(J,{key:0,editDocument:e.editDocument,onCloseModal:K.closeModalHandler,folders:e.folders,onGetFolder:K.refreshData,current_folder:e.current_folder},null,8,["editDocument","onCloseModal","folders","onGetFolder","current_folder"])):(0,o.kq)("",!0),M.showMenu?((0,o.wg)(),(0,o.iD)("div",{key:1,class:"context_overlay",onClick:t[1]||(t[1]=(...e)=>K.closeContextMenu&&K.closeContextMenu(...e))})):(0,o.kq)("",!0),M.showMenu?((0,o.wg)(),(0,o.j4)(Q,{key:2,actions:M.contextMenuActions,onActionClicked:K.handleActionClick,x:M.menuX,y:M.menuY},null,8,["actions","onActionClicked","x","y"])):(0,o.kq)("",!0)])])}var Q=s(4870),ee=s(4677),te=s(3535),se=s(6733),oe=s(4806),ae=s.n(oe),re={components:{ContextMenu:te.Z,EditDocument:se.Z},data(){return{toast:(0,ee.pm)(),baseUrl:this.baseApiUrl,token:localStorage.getItem("edms_token"),showMenu:(0,Q.iH)(!1),menuX:(0,Q.iH)(0),menuY:(0,Q.iH)(0),targetRow:(0,Q.iH)({}),contextMenuActions:(0,Q.iH)([{label:"Open",action:"open"},{label:"Edit",action:"edit"},{label:"Delete",action:"delete"}]),isActive:null,searchTerm:"",sortedColumn:"start_folder",sortOrder:"asc",workflows:[],editWorkflow:(0,Q.iH)({}),showEditWorkflow:(0,Q.iH)(!1)}},computed:{filteredRows(){let e=this.workflows;if(e.forEach((e=>{e["start_folder"]=e.find((e=>0==e.previous)).folder.name,e["end_folder"]=e.find((e=>1==e.is_last)).folder.name,e["steps_count"]=e.length,e["updated_at"]=new Date(e.sort(((e,t)=>e.updated_at-t.updated_at))[e.length-1].updated_at).toLocaleString()})),this.searchTerm){const t=this.searchTerm.toLowerCase();e=e.filter((e=>Object.values(e).some((e=>e.toString().toLowerCase().includes(t)))))}return this.sortedColumn&&(e=ae().orderBy(e,[this.sortedColumn],[this.sortOrder])),e}},mounted(){this.fetchWorkflows()},methods:{openItem(e){let t=this.baseUrl+"/api/showPdf/"+e.document_versions.find((e=>1==e.main_file)).physical_path.split("/")[2],s=!0;this.$emit("show-viewer",t,s)},highlistItem(e){this.isActive=e.id,this.$emit("update-select-document",e)},showContextMenu(e,t){e.preventDefault(),this.showMenu=!0,this.targetRow=t,this.menuX=e.clientX-430,this.menuY=e.clientY-180},closeContextMenu(){this.showMenu=!1},async handleActionClick(e){switch(this.closeContextMenu(),e){case"open":this.isActive=this.targetRow.id,this.$emit("update-select-document",this.targetRow),this.openItem(this.targetRow);break;case"edit":this.editDocument=this.targetRow,this.showEditDocument=!0;break;case"delete":this.$swal.fire({title:"Are you sure?",text:"Once deleted, you will not be able to recover this File and All It's Contents!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",reverseButtons:!0,showLoaderOnConfirm:!0}).then((e=>{e.isConfirmed?fetch(this.baseUrl+"/api/folder/workflows/delete/"+this.targetRow.id,{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}).then((e=>e.json())).then((e=>{403==e.data?this.toast.error(e.message,{timeout:5e3}):(this.toast.success(e.message,{timeout:5e3}),this.$emit("get-folder",this.targetRow.folder_id))})):this.toast.success("Folder is safe!",{timeout:5e3})}));break;default:break}},sortBy(e){this.sortedColumn==e?this.sortOrder="asc"===this.sortOrder?"desc":"asc":(this.sortedColumn=e,this.sortOrder="asc")},closeModalHandler(){this.showEditDocument=!1},refreshData(e){this.$emit("get-folder",e)},fetchData(e){this.$emit("get-folder",this.$props.current_folder.id,e)},async fetchWorkflows(){try{const e=await fetch(this.baseUrl+"/api/workflows",{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}),t=await e.json();0==t.success?this.toast.error(t.message,{timeout:2e3}):(this.toast.success(t.message,{timeout:2e3}),this.workflows=t.data.data)}catch(e){console.error("Error fetching bookmarks:",e)}}}},ie=s(89);const le=(0,ie.Z)(re,[["render",J],["__scopeId","data-v-9077ffcc"]]);var ne=le}}]);
//# sourceMappingURL=798.54e85261.js.map