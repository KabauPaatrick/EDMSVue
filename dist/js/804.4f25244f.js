"use strict";(self["webpackChunkedmsvue"]=self["webpackChunkedmsvue"]||[]).push([[804],{3478:function(e,t,o){o.r(t),o.d(t,{default:function(){return v}});var r=o(3396),s=o(7139);const i={class:"container-fluid"},n={class:"content y"},a={class:"container-fluid px-5 py-2 bg-light rounded"};function d(e,t,o,d,h,c){const l=(0,r.up)("TopNav"),u=(0,r.up)("ListView"),p=(0,r.up)("GridView"),w=(0,r.up)("DocumentViewer"),f=(0,r.up)("PropertiesSideBar");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",{class:"content",style:(0,s.j5)({width:h.openProperties?"65vw":e.auto})},[(0,r._)("div",i,[(0,r._)("div",n,[(0,r._)("div",a,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(c.current_folder_path,(e=>((0,r.wg)(),(0,r.iD)("span",{key:e}," > "+(0,s.zw)(e),1)))),128))]),(0,r.Wm)(l,{onShowListView:c.showListView,onShowGridView:c.showGridView,onShowProperties:c.showProperties,onShowReport:e.showReport,folders:h.folders,onGetFolder:c.refreshData},null,8,["onShowListView","onShowGridView","onShowProperties","onShowReport","folders","onGetFolder"]),h.listview?((0,r.wg)(),(0,r.j4)(u,{key:0,documents:h.documents,pagination:h.pagination,folders:h.folders,onUpdateSelectDocument:c.updateSelectDocument,onUpdateCurrent_folder:c.updateCurrentFolder,onOpenFolder:t[0]||(t[0]=t=>e.$emit("open-folder",e.item)),onShowViewer:c.renderPdfViewer,onGetFolder:c.refreshData},null,8,["documents","pagination","folders","onUpdateSelectDocument","onUpdateCurrent_folder","onShowViewer","onGetFolder"])):(0,r.kq)("",!0),h.gridview?((0,r.wg)(),(0,r.j4)(p,{key:1,documents:h.documents,pagination:h.pagination,folders:h.folders,onOpenFolder:t[1]||(t[1]=t=>e.$emit("open-folder",e.item)),onShowViewer:c.renderPdfViewer,onUpdateCurrent_folder:c.updateCurrentFolder,onUpdateSelectDocument:c.updateSelectDocument,onGetFolder:c.refreshData},null,8,["documents","pagination","folders","onShowViewer","onUpdateCurrent_folder","onUpdateSelectDocument","onGetFolder"])):(0,r.kq)("",!0),h.showViewer?((0,r.wg)(),(0,r.j4)(w,{key:2,actual_file:h.actual_file},null,8,["actual_file"])):(0,r.kq)("",!0)])])],4),h.openProperties?((0,r.wg)(),(0,r.j4)(f,{key:0,style:(0,s.j5)({width:h.openProperties?"25vw":"0vw"}),onHideSidebar:c.hideSidebar,document:h.document,current_folder:c.current_folder,onGetFolder:c.refreshData},null,8,["style","onHideSidebar","document","current_folder","onGetFolder"])):(0,r.kq)("",!0)],64)}o(560);var h=o(5418),c=o(8678),l=o(3810),u=o(5509),p=o(7475),w=o(4677),f=o(4870),m={components:{ListView:h.Z,GridView:c.Z,TopNav:l.Z,PropertiesSideBar:u.Z,DocumentViewer:p.Z},data(){return{toast:(0,w.pm)(),baseUrl:this.baseApiUrl,token:localStorage.getItem("edms_token"),recent_documents:[],recent_folders:[],target_folder:(0,f.qj)(0),listview:!0,gridview:!1,openProperties:!1,documents:[],folders:[],document:{},actual_file:"",showViewer:!1,pagination:{links:"",meta:""}}},computed:{current_folder(){let e={};return this.target_folder>0&&(e=this.folders.find((e=>e.id==this.target_folder))?this.folders.find((e=>e.id==this.target_folder)):{}),e},current_folder_path(){return this.current_folder.path?this.current_folder.path.split("/"):{}}},mounted(){this.recent_documents=this.fetchDocumentRecents(),this.recent_folders=this.fetchFolderRecents(),Array.isArray(this.recent_folders)&&this.recent_folders.forEach((e=>{this.getFolders(e)})),Array.isArray(this.recent_documents)&&this.recent_documents.forEach((e=>{this.getDocuments(e)}))},methods:{showGridView(){this.listview=!1,this.gridview=!0,this.openReport=!1,this.showViewer=!1},showListView(){this.listview=!0,this.gridview=!1,this.openReport=!1,this.showViewer=!1},showProperties(){this.openProperties=!0},hideSidebar(){this.openProperties=!1},async getFolders(e){this.$progress.start();const t=await fetch(this.baseUrl+"/api/folder/show/"+e,{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}),o=await t.json();0==o.success?this.toast.error(o.message,{timeout:2e3}):(this.toast.success(o.message,{timeout:2e3}),this.folders.push(o.data.data)),this.$progress.finish()},async getDocuments(e){this.$progress.start();const t=await fetch(this.baseUrl+"/api/folder/document/show/"+e,{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}),o=await t.json();0==o.success?this.toast.error(o.message,{timeout:2e3}):(this.toast.success(o.message,{timeout:2e3}),this.documents.push(o.data.data),this.pagination.links=o.data.links,this.pagination.meta=o.data.meta),this.$progress.finish()},updateSelectDocument(e){this.document=e,this.updateCurrentFolder(e.folder)},updateCurrentFolder(e){this.target_folder=e.id},renderPdfViewer(e,t){this.actual_file=e,this.showViewer=t,this.listview=!1,this.gridview=!1,this.openReport=!1},refreshData(){this.folders=[],this.documents=[],this.recent_folders.forEach((e=>{this.getFolders(e)})),this.recent_documents.forEach((e=>{this.getDocuments(e)}))},async fetchDocumentRecents(){try{const e=await fetch(this.baseUrl+"/api/recent-views",{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}),t=await e.json();let o=t.filter((e=>"document"==e.type));return o.map((({item_id:e})=>e))}catch(e){console.error("Error fetching Recents:",e)}},async fetchFolderRecents(){try{const e=await fetch(this.baseUrl+"/api/recent-views",{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}),t=await e.json();let o=t.filter((e=>"folder"==e.type));return o.map((({item_id:e})=>e))}catch(e){console.error("Error fetching Recents:",e)}}}},g=o(89);const _=(0,g.Z)(m,[["render",d]]);var v=_}}]);
//# sourceMappingURL=804.4f25244f.js.map