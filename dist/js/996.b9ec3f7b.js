"use strict";(self["webpackChunkedmsvue"]=self["webpackChunkedmsvue"]||[]).push([[996],{996:function(e,t,o){o.r(t),o.d(t,{default:function(){return Vt}});var s=o(3396),r=o(7139);const i={class:"container-fluid"},a={class:"content y"},n={class:"container-fluid px-5 py-2 bg-light rounded"},l={class:"row ml-3"},d={class:"col-9"};function c(e,t,o,c,h,u){const m=(0,s.up)("TopNav"),p=(0,s.up)("FolderTree"),_=(0,s.up)("ListView"),f=(0,s.up)("GridView"),w=(0,s.up)("ReportView"),g=(0,s.up)("DocumentViewer"),k=(0,s.up)("PropertiesSideBar");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",{class:"content",style:(0,r.j5)({width:h.openProperties?"75%":"100%"})},[(0,s._)("div",i,[(0,s._)("div",a,[(0,s._)("div",n,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(u.current_folder_path,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e}," > "+(0,r.zw)(e),1)))),128))]),(0,s.Wm)(m,{onShowListView:u.showListView,onShowGridView:u.showGridView,onShowProperties:u.showProperties,onShowReport:u.showReport,folders:h.folders,onGetFolder:u.refreshData,current_folder:u.current_folder},null,8,["onShowListView","onShowGridView","onShowProperties","onShowReport","folders","onGetFolder","current_folder"]),(0,s._)("div",l,[h.showViewer?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(p,{key:0,folders:h.folders,current_folder:u.current_folder,class:"col-3",onGetFolder:u.refreshData},null,8,["folders","current_folder","onGetFolder"])),(0,s._)("div",d,[h.listview?((0,s.wg)(),(0,s.j4)(_,{key:0,current_folder:u.current_folder,documents:h.documents,pagination:h.pagination,target_folder:h.target_folder,folders:h.folders,onUpdateSelectDocument:u.updateSelectDocument,onShowViewer:u.renderPdfViewer,onGetFolder:u.refreshData},null,8,["current_folder","documents","pagination","target_folder","folders","onUpdateSelectDocument","onShowViewer","onGetFolder"])):(0,s.kq)("",!0),h.gridview?((0,s.wg)(),(0,s.j4)(f,{key:1,current_folder:u.current_folder,documents:h.documents,pagination:h.pagination,target_folder:h.target_folder,folders:h.folders,onUpdateSelectDocument:u.updateSelectDocument,onShowViewer:u.renderPdfViewer,onGetFolder:u.refreshData},null,8,["current_folder","documents","pagination","target_folder","folders","onUpdateSelectDocument","onShowViewer","onGetFolder"])):(0,s.kq)("",!0),h.openReport?((0,s.wg)(),(0,s.j4)(w,{key:2})):(0,s.kq)("",!0)])]),h.showViewer?((0,s.wg)(),(0,s.j4)(g,{key:0,actual_file:h.actual_file,class:"ml-3 mr-5"},null,8,["actual_file"])):(0,s.kq)("",!0)])])],4),h.openProperties?((0,s.wg)(),(0,s.j4)(k,{key:0,style:(0,r.j5)({width:h.openProperties?"25%":"0%"}),onHideSidebar:u.hideSidebar,document:h.document,current_folder:u.current_folder,onGetFolder:u.refreshData},null,8,["style","onHideSidebar","document","current_folder","onGetFolder"])):(0,s.kq)("",!0)],64)}o(560);var h=o(9242);const u=e=>((0,s.dD)("data-v-58e2b9fc"),e=e(),(0,s.Cn)(),e),m={class:"x y"},p={class:"card elevation-3"},_={class:"card-header"},f={class:"card-title"},w={class:"card-body table-responsive"},g={class:"row"},k=u((()=>(0,s._)("div",{class:"col-md-9"},null,-1))),b={class:"col-md-2 ml-3"},y={class:"form-group"},v={class:"table table-hover table-bordered"},C={class:"thead-light"},D=u((()=>(0,s._)("th",null,"#",-1))),x={key:0},A=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0",style:{border:"none"}},"arrow_drop_up",-1))),M=[A],R={key:1},B=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0",style:{border:"none"}},"arrow_drop_down",-1))),F=[B],S={key:2},z=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0 comparision_icon",style:{border:"none"}},"compare_arrows",-1))),j=[z],T={key:0},$=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0",style:{border:"none"}},"arrow_drop_up",-1))),E=[$],O={key:1},U=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0",style:{border:"none"}},"arrow_drop_down",-1))),V=[U],H={key:2},I=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0 comparision_icon",style:{border:"none"}},"compare_arrows",-1))),G=[I],P={key:0},q=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0",style:{border:"none"}},"arrow_drop_up",-1))),Y=[q],Z={key:1},L=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0",style:{border:"none"}},"arrow_drop_down",-1))),X=[L],N={key:2},W=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0 comparision_icon",style:{border:"none"}},"compare_arrows",-1))),J=[W],K={key:0},Q=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0",style:{border:"none"}},"arrow_drop_up",-1))),ee=[Q],te={key:1},oe=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0",style:{border:"none"}},"arrow_drop_down",-1))),se=[oe],re={key:2},ie=u((()=>(0,s._)("span",{class:"material-symbols-outlined col-md-2 mr-1 pr-0 comparision_icon",style:{border:"none"}},"compare_arrows",-1))),ae=[ie],ne=["onContextmenu"],le={key:0,class:"material-symbols-outlined",style:{"font-size":"30px"}},de={key:1,class:"material-symbols-outlined",style:{"font-size":"30px"}},ce=["onClick"],he=["onClick"],ue=["onClick"],me=["onClick"];function pe(e,t,o,i,a,n){const l=(0,s.up)("ContextMenu");return(0,s.wg)(),(0,s.iD)("div",m,[(0,s._)("div",p,[(0,s._)("div",_,[(0,s._)("h3",f,[(0,s._)("b",null,(0,r.zw)(o.folder?o.folder.name:""),1)])]),(0,s._)("div",w,[(0,s._)("div",g,[k,(0,s._)("div",b,[(0,s._)("form",y,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.searchTerm=e),placeholder:"Search...",class:"form-group rounded"},null,512),[[h.nr,a.searchTerm]])])])]),(0,s._)("table",v,[(0,s._)("thead",C,[(0,s._)("tr",null,[D,(0,s._)("th",{onClick:t[1]||(t[1]=e=>n.sortBy("document_name"))},["document_name"==a.sortedColumn&&"asc"==a.sortOrder?((0,s.wg)(),(0,s.iD)("i",x,M)):"document_name"==a.sortedColumn&&"desc"==a.sortOrder?((0,s.wg)(),(0,s.iD)("i",R,F)):((0,s.wg)(),(0,s.iD)("i",S,j)),(0,s.Uk)(" Name ")]),(0,s._)("th",{onClick:t[2]||(t[2]=e=>n.sortBy("updated_at"))},["updated_at"==a.sortedColumn&&"asc"==a.sortOrder?((0,s.wg)(),(0,s.iD)("i",T,E)):"updated_at"==a.sortedColumn&&"desc"==a.sortOrder?((0,s.wg)(),(0,s.iD)("i",O,V)):((0,s.wg)(),(0,s.iD)("i",H,G)),(0,s.Uk)(" Date Modified ")]),(0,s._)("th",{onClick:t[3]||(t[3]=e=>n.sortBy("doc_version_name"))},["doc_version_name"==a.sortedColumn&&"asc"==a.sortOrder?((0,s.wg)(),(0,s.iD)("i",P,Y)):"doc_version_name"==a.sortedColumn&&"desc"==a.sortOrder?((0,s.wg)(),(0,s.iD)("i",Z,X)):((0,s.wg)(),(0,s.iD)("i",N,J)),(0,s.Uk)(" Version ")]),(0,s._)("th",{onClick:t[4]||(t[4]=e=>n.sortBy("doc_file_size"))},["doc_file_size"==a.sortedColumn&&"asc"==a.sortOrder?((0,s.wg)(),(0,s.iD)("i",K,ee)):"doc_file_size"==a.sortedColumn&&"desc"==a.sortOrder?((0,s.wg)(),(0,s.iD)("i",te,se)):((0,s.wg)(),(0,s.iD)("i",re,ae)),(0,s.Uk)(" Size (mbs) ")])])]),(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.filteredRows,((e,t)=>((0,s.wg)(),(0,s.iD)("tr",{key:t,class:(0,r.C_)({"table-active":a.isActive==e.id}),onContextmenu:(0,h.iM)((t=>n.showContextMenu(t,e)),["prevent"])},[(0,s._)("td",null,[Array.isArray(a.bookmark_documents)&&a.bookmark_documents.includes(e.id)?((0,s.wg)(),(0,s.iD)("span",le,"book")):((0,s.wg)(),(0,s.iD)("span",de,"insert_drive_file"))]),(0,s._)("td",{onClick:o=>n.highlistItem(e,t)},(0,r.zw)(e.document_name),9,ce),(0,s._)("td",{onClick:o=>n.highlistItem(e,t)},(0,r.zw)(new Date(e.updated_at).toLocaleString()),9,he),(0,s._)("td",{onClick:o=>n.highlistItem(e,t)},(0,r.zw)(e.doc_version_name),9,ue),(0,s._)("td",{onClick:o=>n.highlistItem(e,t)},(0,r.zw)(e.doc_file_size)+" MB",9,me)],42,ne)))),128)),a.showMenu?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"context_overlay",onClick:t[5]||(t[5]=(...e)=>n.closeContextMenu&&n.closeContextMenu(...e))})):(0,s.kq)("",!0),a.showMenu?((0,s.wg)(),(0,s.j4)(l,{key:1,actions:a.contextMenuActions,onActionClicked:n.handleActionClick,x:a.menuX,y:a.menuY},null,8,["actions","onActionClicked","x","y"])):(0,s.kq)("",!0)])])])])])}var _e=o(4870),fe=o(3535),we=o(4806),ge=o.n(we),ke={components:{ContextMenu:fe.Z},props:{documents:Array,folder:{},pagination:Object},data(){return{showMenu:(0,_e.iH)(!1),menuX:(0,_e.iH)(0),menuY:(0,_e.iH)(0),targetRow:(0,_e.iH)({}),contextMenuActions:(0,_e.iH)([{label:"Edit",action:"edit"},{label:"Delete",action:"delete"},{label:"Bookmark",action:"bookmark"}]),isActive:null,searchTerm:"",sortedColumn:"updated_at",sortOrder:"asc",bookmark_documents:JSON.parse(localStorage.getItem("bookmark_documents"))||[]}},computed:{filteredRows(){let e=this.$props.documents;if(e.forEach((e=>{e["updated_at"]=e.document_versions.find((e=>1==e.main_file))?e.document_versions.find((e=>1==e.main_file)).updated_at:e.updated_at,e["doc_version_name"]=e.document_versions.find((e=>1==e.main_file))?e.document_versions.find((e=>1==e.main_file)).version_name:"",e["doc_file_size"]=e.document_versions.find((e=>1==e.main_file))?parseInt(e.document_versions.find((e=>1==e.main_file)).file_size).toFixed(4):""})),this.searchTerm){const t=this.searchTerm.toLowerCase();e=e.filter((e=>Object.values(e).some((e=>e.toString().toLowerCase().includes(t)))))}return this.sortedColumn&&(e=ge().orderBy(e,[this.sortedColumn],[this.sortOrder])),e}},methods:{openItem(e){let t=this.baseUrl+"/api/showPdf/"+e.path.split("/")[2],o=!0;this.$emit("show-viewer",t,o)},highlistItem(e){this.isActive=e.id,this.$emit("update-select-document",e)},showContextMenu(e,t){e.preventDefault(),this.showMenu=!0,this.targetRow=t,this.menuX=e.clientX-430,this.menuY=e.clientY-180},closeContextMenu(){this.showMenu=!1},handleActionClick(e){switch(this.closeContextMenu(),e){case"bookmark":this.bookmark_documents.includes(parseInt(this.targetRow.id))?this.bookmark_documents=this.bookmark_documents.filter((e=>e!==this.targetRow.id)):this.bookmark_documents.push(this.targetRow.id),localStorage.setItem("bookmark_documents",JSON.stringify(this.bookmark_documents));break;default:break}},sortBy(e){this.sortedColumn==e?this.sortOrder="asc"===this.sortOrder?"desc":"asc":(this.sortedColumn=e,this.sortOrder="asc")}}},be=o(89);const ye=(0,be.Z)(ke,[["render",pe],["__scopeId","data-v-58e2b9fc"]]);var ve=ye;const Ce=e=>((0,s.dD)("data-v-1cf998fa"),e=e(),(0,s.Cn)(),e),De={class:"x y"},xe={class:"card elevation-3"},Ae={class:"card-header"},Me={class:"card-title"},Re={class:"card-body table-responsive"},Be={class:"row"},Fe=Ce((()=>(0,s._)("div",{class:"col-md-9"},null,-1))),Se={class:"col-md-2 ml-3"},ze={class:"form-group"},je={key:0,class:"row"},Te=["onClick"],$e=["src","onContextmenu"],Ee={key:0,class:"material-symbols-outlined corner-icon",style:{"font-size":"20px"}},Oe={class:"card-footer clearfix"},Ue={class:"pagination pagination-sm m-0 float-right"},Ve={class:"page-item"},He=["disabled"],Ie={class:"page-item"},Ge=["disabled"],Pe={class:"page-item page-link"},qe={class:"page-item"},Ye=["disabled"],Ze={class:"page-item"},Le=["disabled"];function Xe(e,t,o,i,a,n){const l=(0,s.up)("center"),d=(0,s.up)("ContextMenu"),c=(0,s.up)("EditDocument");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",De,[(0,s._)("div",xe,[(0,s._)("div",Ae,[(0,s._)("h3",Me,[(0,s._)("b",null,(0,r.zw)(o.current_folder?o.current_folder.name:""),1)])]),(0,s._)("div",Re,[(0,s._)("div",Be,[Fe,(0,s._)("div",Se,[(0,s._)("form",ze,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.searchTerm=e),placeholder:"Search...",class:"form-group rounded"},null,512),[[h.nr,a.searchTerm]])])])]),n.filteredRows&&n.filteredRows.length?((0,s.wg)(),(0,s.iD)("div",je,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.filteredRows,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e.id,class:"column-md-3 thumbnail-container",onClick:t=>n.highlistItem(e,e.id)},[(0,s._)("img",{src:e.dataUrl,alt:"Thumbnail",style:{width:"150px",height:"200px",margin:"2px"},class:(0,r.C_)({"thumbnail-active":a.isActive==e.id}),onContextmenu:(0,h.iM)((t=>n.showContextMenu(t,e)),["prevent"])},null,42,$e),Array.isArray(a.bookmark_documents)&&a.bookmark_documents.includes(e.id)?((0,s.wg)(),(0,s.iD)("span",Ee,"stars")):(0,s.kq)("",!0),(0,s.Wm)(l,null,{default:(0,s.w5)((()=>[(0,s._)("span",null,(0,r.zw)(e.document_name),1)])),_:2},1024),(0,s.Wm)(l,null,{default:(0,s.w5)((()=>[(0,s._)("span",null,(0,r.zw)(e.size)+" MB",1)])),_:2},1024),(0,s.Wm)(l,null,{default:(0,s.w5)((()=>[(0,s._)("span",null,(0,r.zw)(e.updated_at),1)])),_:2},1024),(0,s.Wm)(l,null,{default:(0,s.w5)((()=>[(0,s._)("span",null,"Document Version: "+(0,r.zw)(e.version),1)])),_:2},1024)],8,Te)))),128))])):(0,s.kq)("",!0),a.showMenu?((0,s.wg)(),(0,s.iD)("div",{key:1,class:"context_overlay",onClick:t[1]||(t[1]=(...e)=>n.closeContextMenu&&n.closeContextMenu(...e))})):(0,s.kq)("",!0),a.showMenu?((0,s.wg)(),(0,s.j4)(d,{key:2,actions:a.contextMenuActions,onActionClicked:n.handleActionClick,x:a.menuX,y:a.menuY},null,8,["actions","onActionClicked","x","y"])):(0,s.kq)("",!0)]),(0,s._)("div",Oe,[(0,s._)("ul",Ue,[(0,s._)("li",Ve,[(0,s._)("a",{class:"page-link",href:"#",onClick:t[2]||(t[2]=e=>n.fetchData(o.pagination.meta.current_page-1)),disabled:1===o.pagination.meta.current_page},"«",8,He)]),(0,s._)("li",Ie,[(0,s._)("a",{class:"page-link",href:"#",onClick:t[3]||(t[3]=e=>n.fetchData(o.pagination.meta.current_page-1)),disabled:1===o.pagination.meta.current_page},"First",8,Ge)]),(0,s._)("span",Pe,"Page "+(0,r.zw)(o.pagination.meta.current_page)+" of "+(0,r.zw)(o.pagination.meta.total),1),(0,s._)("li",qe,[(0,s._)("a",{class:"page-link",href:"#",onClick:t[4]||(t[4]=e=>n.fetchData(o.pagination.meta.current_page-1)),disabled:1===o.pagination.meta.current_page},"Last",8,Ye)]),(0,s._)("li",Ze,[(0,s._)("a",{class:"page-link",href:"#",onClick:t[5]||(t[5]=e=>n.fetchData(o.pagination.meta.current_page+1)),disabled:o.pagination.meta.current_page===o.pagination.meta.total},"»",8,Le)])])])])]),a.showEditDocument?((0,s.wg)(),(0,s.j4)(c,{key:0,editDocument:a.editDocument,onCloseModal:n.closeModalHandler,folders:o.folders,onGetFolder:n.refreshData,current_folder:o.current_folder},null,8,["editDocument","onCloseModal","folders","onGetFolder","current_folder"])):(0,s.kq)("",!0)],64)}o(4224),o(1121),o(7133);var Ne=o(8003),We=o(6733),Je={components:{ContextMenu:fe.Z,EditDocument:We.Z},props:{documents:Array,current_folder:{},pagination:Object,folders:Array},data(){return{baseUrl:this.baseApiUrl,token:localStorage.getItem("edms_token"),showMenu:(0,_e.iH)(!1),menuX:(0,_e.iH)(0),menuY:(0,_e.iH)(0),targetRow:(0,_e.iH)({}),contextMenuActions:(0,_e.iH)([{label:"Open",action:"open"},{label:"Edit",action:"edit"},{label:"Delete",action:"delete"},{label:"Bookmark",action:"bookmark"}]),isActive:null,searchTerm:"",sortedColumn:"updated_at",sortOrder:"asc",bookmark_documents:[],thumbnails:[],editDocument:(0,_e.iH)({}),showEditDocument:(0,_e.iH)(!1)}},watch:{"$props.documents":{immediate:!0,handler(e){this.$progress.start(),this.thumbnails=[],e.forEach((e=>{this.parseFile(e)})),this.$progress.finish()}}},mounted(){this.bookmark_documents=this.fetchDocumentBookmarks()},computed:{filteredRows(){this.$progress.start();let e=this.thumbnails;if(this.searchTerm){const t=this.searchTerm.toLowerCase();e=e.filter((e=>Object.values(e).some((e=>e.toString().toLowerCase().includes(t)))))}return this.sortedColumn&&(e=ge().orderBy(e,[this.sortedColumn],[this.sortOrder])),this.$progress.finish(),e}},methods:{async parseFile(e){try{let t=e.document_versions.find((e=>1==e.main_file)).physical_path,o=this.baseUrl+"/api/showPdf/"+t.split("/")[2];const s=await fetch(o,{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET,POST,PATCH,OPTIONS"}}),r=await s.arrayBuffer(),i=await Ne.getDocument({data:new Uint8Array(r)}).promise,a=await i.getPage(1),n=a.getViewport({scale:1}),l=document.createElement("canvas"),d=l.getContext("2d");l.width=n.width,l.height=n.height;const c={canvasContext:d,viewport:n};await a.render(c).promise;const h=l.toDataURL("image/png");e["path"]=e.document_versions.find((e=>1==e.main_file)).physical_path,e["dataUrl"]=h,e["updated_at"]=new Date(e.document_versions.find((e=>1==e.main_file))?e.document_versions.find((e=>1==e.main_file)).updated_at:e.updated_at).toLocaleDateString(),e["version"]=e.document_versions.find((e=>1==e.main_file))?e.document_versions.find((e=>1==e.main_file)).version_name:"",e["size"]=e.document_versions.find((e=>1==e.main_file))?parseInt(e.document_versions.find((e=>1==e.main_file)).file_size).toFixed(4):"",this.thumbnails.push(e)}catch(t){console.log("Error in fetch"),console.log(t)}},openItem(e){this.isActive=e.id,this.$emit("update-select-document",e);let t=this.baseUrl+"/api/showPdf/"+e.path.split("/")[2],o=!0;this.$emit("show-viewer",t,o)},highlistItem(e,t){this.isActive=t,this.$emit("update-select-document",e)},showContextMenu(e,t){e.preventDefault(),this.showMenu=!0,this.targetRow=t,this.menuX=e.clientX-430,this.menuY=e.clientY-180},closeContextMenu(){this.showMenu=!1},handleActionClick(e){switch(this.closeContextMenu(),e){case"open":this.openItem(this.targetRow);break;case"bookmark":this.bookmark_documents.includes(parseInt(this.targetRow.id))?(this.postBookMarks(this.targetRow,"document"),this.bookmark_documents=this.bookmark_documents.filter((e=>e!==this.targetRow.id))):(this.postBookMarks(this.targetRow,"document"),this.bookmark_documents.push(this.targetRow.id));break;case"edit":this.editDocument=this.targetRow,this.showEditDocument=!0;break;case"delete":this.$swal.fire({title:"Are you sure?",text:"Once deleted, you will not be able to recover this File and All It's Contents!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",reverseButtons:!0,showLoaderOnConfirm:!0}).then((e=>{e.isConfirmed?fetch(this.baseUrl+"/api/folder/documents/delete/"+this.targetRow.id,{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}).then((e=>e.json())).then((e=>{403==e.data?this.toast.error(e.message,{timeout:5e3}):(this.toast.success(e.message,{timeout:5e3}),this.$emit("get-folder",this.targetRow.folder_id))})):this.toast.success("Folder is safe!",{timeout:5e3})}));break;default:break}},async postBookMarks(e,t){const o=await fetch(this.baseUrl+"/api/bookmarks",{method:"POST",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"},data:{item_id:e.id,type:t}}),s=await o.json();console.log(s)},sortBy(e){this.sortedColumn==e?this.sortOrder="asc"===this.sortOrder?"desc":"asc":(this.sortedColumn=e,this.sortOrder="asc")},closeModalHandler(){this.showEditDocument=!1},refreshData(e){this.$emit("get-folder",e)},fetchData(e){this.$emit("get-folder",this.$props.current_folder.id,e)},async fetchDocumentBookmarks(){try{const e=await fetch(this.baseUrl+"/api/bookmarks",{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}),t=await e.json();let o=t.filter((e=>"document"==e.type));return o.map((({item_id:e})=>e))}catch(e){console.error("Error fetching bookmarks:",e)}}}};const Ke=(0,be.Z)(Je,[["render",Xe],["__scopeId","data-v-1cf998fa"]]);var Qe=Ke,et=o(3810),tt=o(5509),ot=o(7475);const st=(0,s.uE)('<input class="g" name="repository_tabv1" type="radio"><div class="x y"><div class="row"><div class="col-md-6"><div class="card elevation-3"><div class="card-header"><h3 class="card-title"><b>Report 1</b></h3></div><div class="card-body"><canvas id="barChart" width="400" height="400"></canvas></div><div class="card-footer clearfix"></div></div></div><div class="col-md-6"><div class="card elevation-3"><div class="card-header"><h3 class="card-title"><b>Report 2</b></h3></div><div class="card-body"><canvas id="doughnutChart" width="400" height="400"></canvas></div><div class="card-footer clearfix"></div></div></div></div><div class="row"><div class="col-md-6"><div class="card elevation-3"><div class="card-header"><h3 class="card-title"><b>Report 3</b></h3></div><div class="card-body"><canvas id="lineChart" width="400" height="400"></canvas></div><div class="card-footer clearfix"></div></div></div><div class="col-md-6"><div class="card elevation-3"><div class="card-header"><h3 class="card-title"><b>Report 3</b></h3></div><div class="card-body"><canvas id="pieChart" width="30%" height="30%"></canvas></div><div class="card-footer clearfix"></div></div></div></div></div>',2),rt=[st];function it(e,t,o,r,i,a){return(0,s.wg)(),(0,s.iD)("div",null,rt)}var at=o(3403),nt={mounted(){function e(){var e=[r,l,u,f];e.forEach((function(e){e&&e.resize()}))}var t={labels:["Category A","Category B","Category C","Category D"],datasets:[{label:"Data Set 1",data:[12,19,3,5],backgroundColor:"rgba(75, 192, 192, 0.5)"}]},o={type:"bar",data:t,options:{scales:{y:{beginAtZero:!0}}}},s=document.getElementById("barChart").getContext("2d"),r=new at.Z(s,o),i={labels:["Jan","Feb","Mar","Apr","May","Jun"],datasets:[{label:"Data Set 1",data:[12,19,3,5,2,3],fill:!1,borderColor:"rgba(75, 192, 192, 1)",tension:.1}]},a={type:"line",data:i},n=document.getElementById("lineChart").getContext("2d"),l=new at.Z(n,a),d={labels:["Category A","Category B","Category C"],datasets:[{data:[30,40,30],backgroundColor:["rgba(255, 99, 132, 0.5)","rgba(75, 192, 192, 0.5)","rgba(54, 162, 235, 0.5)"]}]},c={type:"pie",data:d},h=document.getElementById("pieChart").getContext("2d"),u=new at.Z(h,c),m={labels:["Category A","Category B","Category C"],datasets:[{data:[30,40,30],backgroundColor:["rgba(255, 99, 132, 0.5)","rgba(75, 192, 192, 0.5)","rgba(54, 162, 235, 0.5)"]}]},p={type:"doughnut",data:m},_=document.getElementById("doughnutChart").getContext("2d"),f=new at.Z(_,p);window.addEventListener("resize",(function(){e()})),e()}};const lt=(0,be.Z)(nt,[["render",it]]);var dt=lt;const ct=e=>((0,s.dD)("data-v-43a64978"),e=e(),(0,s.Cn)(),e),ht={class:"card elevation-3 p-0"},ut=ct((()=>(0,s._)("div",{class:"card-header"},[(0,s._)("h3",{class:"card-title"},[(0,s._)("b",null,"Folder Tree")])],-1))),mt={class:"card-body pl-1"},pt={class:"tree"},_t={class:"pl-0 ml-0"},ft=ct((()=>(0,s._)("i",{class:"collapsed"},[(0,s._)("span",{class:"material-symbols-outlined"},"first_page")],-1))),wt=ct((()=>(0,s._)("span",{style:{border:"none"}}," Back",-1))),gt=[ft,wt],kt={key:0},bt=ct((()=>(0,s._)("i",{class:"collapsed"},[(0,s._)("span",{class:"material-symbols-outlined col-md-2",style:{border:"none"}},"folder")],-1))),yt=ct((()=>(0,s._)("i",{class:"expanded"},[(0,s._)("span",{class:"material-symbols-outlined col-md-2",style:{border:"none"}},"folder_open")],-1))),vt={style:{border:"none"},class:"col-md-7 ml-0 pl-0"},Ct={key:0,class:"material-symbols-outlined",style:{"font-size":"15px",border:"none"}},Dt={key:0,id:"{{ current_folder.name }}",class:"collapse show"},xt=["onContextmenu"],At=["onClick"],Mt={class:"collapsed"},Rt={key:0,class:"material-symbols-outlined col-md-2",style:{"font-size":"30px",border:"none"}},Bt={key:1,class:"material-symbols-outlined col-md-2",style:{"font-size":"30px",border:"none"}},Ft={style:{border:"none"},class:"col-md-7 ml-0 pl-0"};function St(e,t,o,i,a,n){const l=(0,s.up)("ContextMenu"),d=(0,s.up)("EditFolder");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",ht,[ut,(0,s._)("div",mt,[(0,s._)("div",pt,[(0,s._)("ul",_t,[(0,s._)("span",{style:{color:"#000","text-decoration":"none"},"data-toggle":"collapse",href:"#back",class:"x y nav","aria-expanded":"false","aria-controls":"back",onClick:t[0]||(t[0]=t=>e.$emit("get-folder",o.current_folder.parent.id))},gt),o.current_folder.name?((0,s.wg)(),(0,s.iD)("li",kt,[(0,s._)("span",{style:{color:"#000","text-decoration":"none"},"data-toggle":"collapse",href:"#{{ current_folder.name }}","aria-expanded":"true","aria-controls":"{{ current_folder.name }}",class:"row ml-1",onContextmenu:t[1]||(t[1]=(0,h.iM)((e=>n.showContextMenu(e,o.current_folder)),["prevent"]))},[bt,yt,(0,s._)("span",vt,[(0,s.Uk)((0,r.zw)(o.current_folder.name)+" ",1),Array.isArray(a.bookmark_folders)&&a.bookmark_folders.includes(o.current_folder.id)?((0,s.wg)(),(0,s.iD)("span",Ct,"stars")):(0,s.kq)("",!0)])],32),o.folders&&o.folders.length?((0,s.wg)(),(0,s.iD)("div",Dt,[(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.folders,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.id,onContextmenu:(0,h.iM)((t=>n.showContextMenu(t,e)),["prevent"])},[(0,s._)("span",{style:{color:"#000","text-decoration":"none"},"data-toggle":"collapse",href:"#{{ folder.name }}","aria-expanded":"false","aria-controls":"{{ folder.name }}",onClick:t=>n.expandTree(t,e.id),class:"row"},[(0,s._)("i",Mt,[Array.isArray(a.bookmark_folders)&&a.bookmark_folders.includes(e.id)?((0,s.wg)(),(0,s.iD)("span",Rt,"folder_special")):((0,s.wg)(),(0,s.iD)("span",Bt,"folder"))]),(0,s._)("span",Ft,(0,r.zw)(e.name),1)],8,At)],40,xt)))),128))])])):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])])])]),a.showMenu?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"context_overlay",onClick:t[2]||(t[2]=(...e)=>n.closeContextMenu&&n.closeContextMenu(...e))})):(0,s.kq)("",!0),a.showMenu?((0,s.wg)(),(0,s.j4)(l,{key:1,actions:a.contextMenuActions,onActionClicked:n.handleActionClick,x:a.menuX,y:a.menuY},null,8,["actions","onActionClicked","x","y"])):(0,s.kq)("",!0),a.showEditFolder?((0,s.wg)(),(0,s.j4)(d,{key:2,editFolder:a.editFolder,onCloseModal:n.closeModalHandler,folders:o.folders,onGetFolder:n.refreshData,current_folder:o.current_folder},null,8,["editFolder","onCloseModal","folders","onGetFolder","current_folder"])):(0,s.kq)("",!0)],64)}var zt=o(4677),jt=o(6138),Tt={components:{ContextMenu:fe.Z,EditFolder:jt.Z},props:{folders:{type:Array,required:!0},current_folder:{type:Object,required:!0}},data(){return{toast:(0,zt.pm)(),baseUrl:this.baseApiUrl,token:localStorage.getItem("edms_token"),showMenu:(0,_e.iH)(!1),menuX:(0,_e.iH)(0),menuY:(0,_e.iH)(0),targetRow:(0,_e.iH)({}),contextMenuActions:(0,_e.iH)([{label:"Edit",action:"edit"},{label:"Delete",action:"delete"},{label:"Bookmark",action:"bookmark"}]),bookmark_folders:[],editFolder:(0,_e.iH)({}),showEditFolder:(0,_e.iH)(!1)}},mounted(){this.bookmark_folders=this.fetchFolderBookmarks()},methods:{expandTree(e,t){this.$emit("get-folder",t)},showContextMenu(e,t){1!=t.id&&(e.preventDefault(),this.showMenu=!0,this.targetRow=t,this.menuX=e.clientX,this.menuY=e.clientY)},closeContextMenu(){this.showMenu=!1},async handleActionClick(e){switch(this.closeContextMenu(),e){case"bookmark":if(Array.isArray(this.bookmark_folders)&&this.bookmark_folders.includes(parseInt(this.targetRow.id))){this.bookmark_folders=this.bookmark_folders.filter((e=>e!=this.targetRow.id));let e=this.$props.folders.find((e=>e.id==this.targetRow.id));this.$props.folders.splice(e,1),this.postBookMarks(this.targetRow,"folder")}else this.postBookMarks(this.targetRow,"folder"),this.bookmark_folders.push(this.targetRow.id);break;case"edit":this.editFolder=this.targetRow,this.showEditFolder=!0;break;case"delete":this.$swal.fire({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Folder and All It's Contents!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",reverseButtons:!0,showLoaderOnConfirm:!0}).then((e=>{e.isConfirmed?fetch(this.baseUrl+"/api/folders/delete/"+this.targetRow.id,{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}).then((e=>e.json())).then((e=>{403==e.data?this.toast.error(e.message,{timeout:5e3}):(this.toast.success(e.message,{timeout:5e3}),this.$emit("get-folder",this.targetRow.parent_folder_id))})):this.toast.success("Folder is safe!",{timeout:5e3})}));break;default:break}},closeModalHandler(){this.showEditFolder=!1},refreshData(e){this.$emit("get-folder",e)},async postBookMarks(e,t){const o=await fetch(this.baseUrl+"/api/bookmarks",{method:"POST",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"},data:{item_id:e.id,type:t}}),s=await o.json();console.log(s)},async fetchFolderBookmarks(){try{const e=await fetch(this.baseUrl+"/api/bookmarks",{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}),t=await e.json();let o=t.filter((e=>"folder"==e.type));return o.map((({item_id:e})=>e))}catch(e){console.error("Error fetching bookmarks:",e)}}}};const $t=(0,be.Z)(Tt,[["render",St],["__scopeId","data-v-43a64978"]]);var Et=$t,Ot={props:{folder_id:String},components:{ListView:ve,GridView:Qe,TopNav:et.Z,PropertiesSideBar:tt.Z,ReportView:dt,FolderTree:Et,DocumentViewer:ot.Z},data(){return{toast:(0,zt.pm)(),baseUrl:this.baseApiUrl,token:localStorage.getItem("edms_token"),recent_documents:[],recent_folders:[],target_folder:this.$props.theTargetFolder?this.$props.theTargetFolder:1,listview:!0,gridview:!1,openReport:!1,openProperties:!1,documents:[],folders:[],document:null,actual_file:"",showViewer:!1,folder:{},pagination:{links:"",meta:""}}},computed:{current_folder(){let e=this.folder;return e},current_folder_path(){return this.current_folder.path?this.current_folder.path.split("/"):""}},mounted(){this.target_folder=this.$route.query.folder_id?this.$route.query.folder_id:1,this.getFolders(this.target_folder),this.getDocuments(this.target_folder),this.recent_documents=this.fetchDocumentRecents(),this.recent_folders=this.fetchFolderRecents()},methods:{showGridView(){this.listview=!1,this.gridview=!0,this.openReport=!1,this.showViewer=!1,this.openProperties=!1},showListView(){this.listview=!0,this.gridview=!1,this.openReport=!1,this.showViewer=!1,this.openProperties=!1},showProperties(){this.openProperties=!0},showReport(){this.listview=!1,this.gridview=!1,this.openReport=!0,this.showViewer=!1,this.openProperties=!1},hideSidebar(){this.openProperties=!1},async getFolders(e){this.$progress.start();const t=await fetch(this.baseUrl+"/api/folder/show/"+e,{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}),o=await t.json();1==o.success?(this.toast.success(o.message,{timeout:2e3}),this.folder=o.data.data,this.folders=this.folder.children.filter((e=>e.id!=e.parent_folder_id))):this.toast.error(o.message,{timeout:2e3}),Array.isArray(this.recent_folders)&&!this.recent_folders.includes(parseInt(this.folder.id))&&(this.postRecents(this.folder,"folder"),this.recent_folders.push(this.folder.id)),this.$progress.finish()},async getDocuments(e,t){this.documents=[];const o=await fetch(this.baseUrl+"/api/folder/"+e+"/documents?page="+t,{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}),s=await o.json();0==s.success?this.toast.error(s.message,{timeout:2e3}):(this.toast.success(s.message,{timeout:2e3}),this.documents=s.data.data,this.pagination.links=s.data.links,this.pagination.meta=s.data.meta)},updateSelectDocument(e){this.document=e,Array.isArray(this.recent_documents)&&!this.recent_documents.includes(this.document.id)&&(this.postRecents(this.document,"document"),this.recent_documents.push(this.document.id))},getChildren(e){return this.folders.filter((t=>t.parent_folder_id==e&&t.id!=e))},refreshData(e,t=1){this.document=null,this.target_folder=e,this.getDocuments(e,t),this.getFolders(e)},renderPdfViewer(e,t){this.actual_file=e,this.showViewer=t,this.listview=!1,this.gridview=!1,this.openReport=!1},async postRecents(e,t){const o=await fetch(this.baseUrl+"/api/recent-views",{method:"POST",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"},data:{item_id:e.id,type:t}}),s=await o.json();console.log(s)},async fetchDocumentRecents(){try{const e=await fetch(this.baseUrl+"/api/recent-views",{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}),t=await e.json();let o=t.filter((e=>"document"==e.type));return o.map((({item_id:e})=>e))}catch(e){console.error("Error fetching Recents:",e)}},async fetchFolderRecents(){try{const e=await fetch(this.baseUrl+"/api/recent-views",{method:"GET",headers:{Authorization:`Bearer ${this.token}`,"Content-type":"application/json"}}),t=await e.json();let o=t.filter((e=>"folder"==e.type));return o.map((({item_id:e})=>e))}catch(e){console.error("Error fetching Recents:",e)}}}};const Ut=(0,be.Z)(Ot,[["render",c]]);var Vt=Ut}}]);
//# sourceMappingURL=996.b9ec3f7b.js.map